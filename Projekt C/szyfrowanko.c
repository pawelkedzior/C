char szyfr (char haslo[16])
{
      char alf[63]={'0','1','2','3','4','5','6','7','8','9','A','B','C','D','E',
                    'F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T',
                    'U','V','W','X','Y','Z','a','b','c','d','e','f','g','h','i',
                    'j','k','l','m','n','o','p','q','r','s','t','u','v','w','x',
                    'y','z','!'};
      char szyf[4][63] = {{'k','l','m','n','o','p','q','r','s','t','U','V','W',
                           'X','Y','Z','0','1','2','3','4','5','6','7','8','9',
                           'a','b','c','d','e','f','g','h','i','j','u','v','w',
                           'x','y','z','A','B','C','D','E','F','G','H','I','J',
                           'K','L','M','N','O','P','Q','R','S','T','!'},
                          {'9','a','b','c','d','e','f','g','h','i','J','K','L',
                           'M','N','O','P','Q','R','S','T','U','V','W','X','Y',
                           'Z','0','1','2','3','4','5','6','7','8','j','k','l',
                           'm','n','o','p','q','r','s','t','u','v','w','x','y',
                           'z','A','B','C','D','E','F','G','H','I','!'},
                          {'e','f','g','h','i','j','k','l','m','n','O','P','Q',
                           'R','S','T','U','V','W','X','Y','Z','0','1','2','3',
                           '4','5','6','7','8','9','a','b','c','d','o','p','q',
                           'r','s','t','u','v','w','x','y','z','A','B','C','D',
                           'E','F','G','H','I','J','K','L','M','N','!'},
                          {'j','k','l','m','n','o','p','q','r','s','T','U','V',
                           'W','X','Y','Z','0','1','2','3','4','5','6','7','8',
                           '9','a','b','c','d','e','f','g','h','i','t','u','v',
                           'w','x','y','z','A','B','C','D','E','F','G','H','I',
                           'J','K','L','M','N','O','P','Q','R','S','!'} 
                         }; //KLUCZ: UJOT
      int kod[16];
      int i,j;
      j=0;
        for (i=0;i<strlen(haslo);i++)
          {
           kod[i]=haslo[i];
           if (kod[i]<58&&kod[i]>47)
              {
                 kod[i]-=48;
              }
           else
               {
                  if (kod[i]<91&&kod[i]>64)
                     {
                         kod[i]-=55;
                     }
                  else
                      {
                          if (kod[i]>96&&kod[i]<123)
                             {
                                kod[i]-=61;
                             }
                          else
                              {
                                 kod[i]=62;
                              }
                      }
               }
           haslo[i]=szyf[j][kod[i]];
           j++;
           j=j%4;
          }
      return *haslo;
}

char deszyfr (char haslo[16])
{
      char alf[37]={'0','1','2','3','4','5','6','7','8','9','A','B','C','D','E',
                    'F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T',
                    'U','V','W','X','Y','Z','!'};
      char szyf[4][63] = {{'k','l','m','n','o','p','q','r','s','t','U','V','W',
                           'X','Y','Z','0','1','2','3','4','5','6','7','8','9',
                           'a','b','c','d','e','f','g','h','i','j','u','v','w',
                           'x','y','z','A','B','C','D','E','F','G','H','I','J',
                           'K','L','M','N','O','P','Q','R','S','T','!'},
                          {'9','a','b','c','d','e','f','g','h','i','J','K','L',
                           'M','N','O','P','Q','R','S','T','U','V','W','X','Y',
                           'Z','0','1','2','3','4','5','6','7','8','j','k','l',
                           'm','n','o','p','q','r','s','t','u','v','w','x','y',
                           'z','A','B','C','D','E','F','G','H','I','!'},
                          {'e','f','g','h','i','j','k','l','m','n','O','P','Q',
                           'R','S','T','U','V','W','X','Y','Z','0','1','2','3',
                           '4','5','6','7','8','9','a','b','c','d','o','p','q',
                           'r','s','t','u','v','w','x','y','z','A','B','C','D',
                           'E','F','G','H','I','J','K','L','M','N','!'},
                          {'j','k','l','m','n','o','p','q','r','s','T','U','V',
                           'W','X','Y','Z','0','1','2','3','4','5','6','7','8',
                           '9','a','b','c','d','e','f','g','h','i','t','u','v',
                           'w','x','y','z','A','B','C','D','E','F','G','H','I',
                           'J','K','L','M','N','O','P','Q','R','S','!'} 
                         }; //KLUCZ: UJOT
      int i,j;
      for (j=0;j<strlen(haslo);j++)
        for (i=0;i<63;i++)
          {
             if (haslo[j]==szyf[j%4][i])
                {
                   haslo[j]=alf[i];
                   break;
                }
          }
      return *haslo;
}
